window.IBikeCPH or= {}

# because this is a .erb file, it will be parsed by ruy first
# we use this to insert needed ENV variables
# note that this means the password will be possible to extract from the js
# that's loaded in the browser

kms_username = "<%= ENV.fetch('KMS_USERNAME') %>"
kms_pswd = "<%= ENV.fetch('KMS_PSWD') %>"

IBikeCPH.config =

  initial_location:
    lat: 55.68
    lng: 12.55
    zoom: 13

  route_styles:
    current:
      color  : '#e00'
      weight  : 5
      opacity : 0.6
    old:
      color   : 'black'
      weight  : 5
      opacity : 0.0
    invalid:
      color   : 'grey'
      weight  : 5
      opacity : 0.3

  # The first tile set is used by default.
  map_tiles: [
    name: 'OpenStreetMap'
    #url: 'http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png'
    #url: 'http://{s}.tiles.mapbox.com/v3/stamen.cphbikes/{z}/{x}/{y}.png'
    url: 'https://tiles.ibikecph.dk/webtiles/{z}/{x}/{y}.png'
    options:
      attribution: 'Map data © OpenStreetMap contributors (ODbL), Imagery © City of Copenhagen.'
  ,
    name: 'IBikeCPH'
    url: 'http://tiles.ibikecph.dk/webtiles/{z}/{x}/{y}.png'
    options:
      attribution: 'Map data &copy 2012 OpenStreetMap contributors, Imagery &copy 2012 IBikeCPH'
  ,
    name: 'I Bike CPH (Big)'
    url: 'http://tiles.ibikecph.dk/tiles/{z}/{x}/{y}.png'
    options:
      attribution: '(work in progress) Map data &copy OpenStreetMap contributors, Design by Stamen Design'
  ,
    name: 'OpenCycleMap'
    url: 'http://{s}.tile.opencyclemap.org/cycle/{z}/{x}/{y}.png'
    options:
      attribution: 'Map data &copy 2012 OpenStreetMap contributors, Imagery by Andy Allan and Dave Stubbs'
  ]

  # The map controls are inserted in the specified order. Supported types:
  # 'zoom', 'layers'.
  map_controls: [
    type     : 'layers'
    position : 'topright'
  ,
    type     : 'goto'
    position : 'topright'
  ,
    type     : 'zoom'
    position : 'topright'
  ]

  maxbounds:
    value: new L.LatLngBounds(new L.LatLng(55.885903, 12.019043), new L.LatLng(55.489553, 12.989209)) # Max bounds of the map

  routing_service:
    base_url: 'https://routes.ibikecph.dk'
    precision: 1e-5
    profiles:
      fast:
        url: 'v5/fast/route'
        speed: 15
      cargo:
        url: 'v5/cargo/route'
        speed: 10
      green:
        url: 'v5/green/route'
        speed: 15

  geocoding_service:
    url: 'https://nominatim.openstreetmap.org/search'
    options:
      'accept-language' : 'da'
      countrycodes      : 'DK'
      viewbox           : '7.6,54.4,15.7,58' # DK, Bornholm and Skåne
      bounded           : '1'
      email             : 'emil.tin@tmf.kk.dk'

  reverse_geocoding_service:
    url: 'https://nominatim.openstreetmap.org/reverse'
    options:
      'accept-language' : 'da'
      addressdetails    : '1'
      email             : 'emil.tin@tmf.kk.dk'

  suggestion_service:
    foursquare:
      url: 'https://api.foursquare.com/v2/venues/suggestcompletion?near=Copenhagen&query='
      token: '&oauth_token=BM2LGKP3TZURURN3R0NFYGQPQH3PU3L2WDNRF1MUJPSKYV1N&v=20130303' # version number should probably be updated, but this still works
    oiorest:
      url: 'https://geo.oiorest.dk/adresser.json?q='
    kms:
      url: 'https://kortforsyningen.kms.dk/Geosearch?service=GEO&resources=Adresser&limit=5&login='+kms_username+'&password='+kms_pswd+'&crs=EPSG:4326&search='
